# Projeto de AutenticaÃ§Ã£o com MVC em PHP

Este Ã© um projeto FULLSTACK em PHP com estrutura MVC (Model-View-Controller), buscando emular um clone de tinder. Foi realizado como um projeto da minha faculdade no 5Âº semestre. Ele consiste de um front end basico e um back end fazendo a funÃ§Ã£o de uma API restful. 

---

## ğŸ“ Estrutura de Pastas

```
â”œâ”€â”€ frontend/             # Arquivos estÃ¡ticos do frontend (ex: React, Vue ou HTML puro)
â”‚   â”œâ”€â”€ components/       # Componentes reutilizÃ¡veis da interface
â”‚   â”œâ”€â”€ pages/            # PÃ¡ginas especÃ­ficas (login, home, etc)
â”‚   â””â”€â”€ scripts/          # Scripts JS de comportamento
â”‚
â”œâ”€â”€ public/               # Pasta pÃºblica acessÃ­vel pelo navegador
â”‚   â”œâ”€â”€ assets/           # Arquivos pÃºblicos como imagens, JS, CSS
â”‚   â””â”€â”€ index.php         # Ponto de entrada da aplicaÃ§Ã£o
â”‚
â”œâ”€â”€ src/                  # CÃ³digo-fonte principal da aplicaÃ§Ã£o
â”‚   â”œâ”€â”€ Config/           # Arquivos de configuraÃ§Ã£o
â”‚   â”œâ”€â”€ Controllers/      # Controladores das rotas
â”‚   â”‚   â””â”€â”€ HomeController.php
â”‚   â”œâ”€â”€ Core/             # NÃºcleo da aplicaÃ§Ã£o (autoload, roteamento, etc)
â”‚   â”‚   â””â”€â”€ App.php
â”‚   â””â”€â”€ Views/            # Arquivos HTML/PHP das views
â”‚       â””â”€â”€ home.php
â”‚
â”œâ”€â”€ storage/              # Pasta para arquivos gerados, cache ou logs
â”‚
â”œâ”€â”€ vendor/               # Bibliotecas e dependÃªncias do Composer
â”‚
â”œâ”€â”€ .gitignore            # Arquivos ignorados pelo Git
â”œâ”€â”€ .htaccess             # Regras de reescrita para o Apache
â”œâ”€â”€ db-credentials.env    # Arquivo com credenciais do banco de dados
â”œâ”€â”€ LICENSE               # LicenÃ§a do projeto
â””â”€â”€ README.md             # Este arquivo :)
```

---

## ğŸ› ï¸ Requisitos

- PHP 7.4+
- Composer
- Servidor Web (Apache ou servidor embutido)
- MySQL ou MariaDB
- ExtensÃµes PHP: `mbstring`, `openssl`, `pdo_mysql`

---

## ğŸš€ Como rodar o projeto

### ğŸ’» No Linux

```bash
git clone https://github.com/Dehrangerz9/tinderclonefmu.git
cd tinderclonefmu

composer install

cp db-credentials.env.example db-credentials.env
# Edite db-credentials.env com seus dados

php -S localhost:8000 -t public
```

### ğŸªŸ No Windows

```powershell
git clone https://github.com/Dehrangerz9/tinderclonefmu.git
cd tinderclonefmu

composer install

copy db-credentials.env.example db-credentials.env
# Edite db-credentials.env com seus dados

php -S localhost:8000 -t public
```
---

## ğŸ“‚ Configurar o banco de dados

As configuraÃ§Ãµes de acesso ao banco de dados devem ser definidas no arquivo `.env` com o nome `db-credentials.env`, localizado na raiz do projeto. Exemplo de configuraÃ§Ã£o:

```dotenv
PGHOST=localhost
PGDATABASE=meubanco
PGUSER=postgres
PGPASSWORD=senha123
```

> ğŸ”’ Certifique-se de que o arquivo `.env` **nÃ£o estÃ¡ versionado** (jÃ¡ estÃ¡ no `.gitignore` por padrÃ£o).

---

### ğŸ› ï¸ Criando o banco de dados

VocÃª pode criar o banco de dados manualmente no seu PostgreSQL com os comandos abaixo.

#### 1. Acesse o terminal do PostgreSQL:
No Linux:
```bash
sudo -u postgres psql
```

No Windows (via PowerShell ou terminal do pgAdmin):
```powershell
psql -U postgres
```

#### 2. Crie o banco de dados:
```sql
CREATE DATABASE meubanco;
```

#### 3. Conecte-se ao banco:
```sql
\c meubanco
```

#### 4. Execute os comandos abaixo para criar as tabelas e tipos necessÃ¡rios:

```sql
-- Tipos ENUM personalizados
CREATE TYPE genero_enum AS ENUM ('masculino', 'feminino', 'nÃ£o-binario', 'outro');
CREATE TYPE genero_interesse_enum AS ENUM ('masculino', 'feminino', 'todos');
CREATE TYPE orientacao_enum AS ENUM ('hetero', 'gay', 'lesbica', 'bi', 'pan', 'outro');

-- Tabela de usuÃ¡rios
CREATE TABLE usuarios (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    senha VARCHAR(255) NOT NULL,
    genero genero_enum NOT NULL,
    bio TEXT,
    nascimento DATE NOT NULL,
    idade INT,                          
    gostos TEXT[],                     
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    genero_interesse genero_interesse_enum,
    orientacao orientacao_enum NOT NULL,
    online BOOLEAN DEFAULT FALSE,       
    ativo BOOLEAN DEFAULT FALSE,        
    token VARCHAR(255),                  
    data_ultimo_login TIMESTAMP
);


-- Tabela de fotos de perfil
CREATE TABLE fotos (
    id SERIAL PRIMARY KEY,
    usuario_id INT REFERENCES usuarios(id) ON DELETE CASCADE,
    caminho VARCHAR(255) NOT NULL,
    posicao INT,
    is_main_photo BOOLEAN DEFAULT FALSE
);

-- Tabela de curtidas
CREATE TABLE curtidas (
    id SERIAL PRIMARY KEY,
    quem_curtiu INT REFERENCES usuarios(id) ON DELETE CASCADE,
    quem_foi_curtido INT REFERENCES usuarios(id) ON DELETE CASCADE,
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela de matches
CREATE TABLE matches (
    id SERIAL PRIMARY KEY,
    usuario1_id INT REFERENCES usuarios(id) ON DELETE CASCADE,
    usuario2_id INT REFERENCES usuarios(id) ON DELETE CASCADE,
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela de mensagens
CREATE TABLE mensagens (
    id SERIAL PRIMARY KEY,
    match_id INT REFERENCES matches(id) ON DELETE CASCADE,
    remetente_id INT REFERENCES usuarios(id) ON DELETE CASCADE,
    texto TEXT NOT NULL,
    enviada_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela de recuperaÃ§Ã£o de senha
CREATE TABLE password_resets (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES usuarios(id) ON DELETE CASCADE,
    token VARCHAR(255) UNIQUE NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- UsuÃ¡rio de exemplo
INSERT INTO usuarios (nome, email, senha, genero, genero_interesse, orientacao)
VALUES (
    'Enzo Boomer',
    'enzo.boomer@example.com',
    '$2b$10$EixZaYVK1fsbw1ZfbX3OXePaWxn96p36HhB5Z/mrulYfDFpZfBd1C', -- bcrypt da senha "123456"
    'masculino',
    'feminino',
    'hetero'
);
```

---


### ğŸ” Rotas da API

| MÃ©todo    | Rota                | DescriÃ§Ã£o                                                   |
|-----------|---------------------|------------------------------------------------------------ |
| **POST**  | `/register`         | Registra um novo usuÃ¡rio                                    |
| **POST**  | `/login`            | Realiza login com email e senha                             |
| **POST**  | `/recover-password` | Envia link de recuperaÃ§Ã£o de senha para o e-mail informado  |
| **POST**  | `/reset-password`   | Redefine a senha do usuÃ¡rio usando token de recuperaÃ§Ã£o     |
| **POST**  | `/like`             | DÃ¡ like em outro usuÃ¡rio                                    |
| **GET**   | `/user-matches`     | Lista todos os matches do usuÃ¡rio logado                    |
| **GET**   | `/to-like-list`     | Retorna uma lista de usuÃ¡rios disponÃ­veis para dar like     |
| **GET**   | `/set-session`      | Rota de teste: cria sessÃ£o com usuÃ¡rio ID 1                 |

> âš ï¸ A rota `/set-session` serve apenas para testes e desenvolvimento. NÃ£o use em produÃ§Ã£o!
> As rotas sÃ£o gerenciadas atravÃ©s do `index.php` na pasta `public` e do roteador presente no `App.php`.

---

Se quiser, posso gerar o `README.md` final como arquivo para vocÃª baixar ou colar direto no repositÃ³rio!

---

## âœ… Exemplo de Registro (`POST /register`)

```json
{
  "nome": "Maria",
  "email": "maria@exemplo.com",
  "senha": "senhaSegura123",
  "genero": "feminino",
  "orientacao": "bi"
}
```

---



## ğŸ“ LicenÃ§a

Este projeto estÃ¡ sob a LicenÃ§a MIT.

---
